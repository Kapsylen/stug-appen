<div class="backdrop" (click)="onCancel()"></div>
<dialog open>
  <h2>Nytt Ärende</h2>
  <form (ngSubmit)="onSubmit()">
    <p>
      <label class="form-group required" for="name">Namn</label>
      <input type="text"
             id="name"
             name="name" [(ngModel)]="enteredName"
             minlength="3"
             maxlength="100"
             #nameInput="ngModel"
      />

      @if (nameInput.errors) {
        @switch (true) {
          @case (nameInput.hasError('minlength')) {
            Rubrik måste vara mellan 3 and 100 tecken.
          }
          @case (nameInput.hasError('maxlength')) {
            Rubrik måste vara mellan 3 and 100 tecken.
          }
        }
      }

    </p>

    <p>
      <label class="form-group required" for="description">Beskrivning</label>
      <input
        type="text"
        id="description"
        name="description" [(ngModel)]="enteredDescription"
        minlength="3"
        maxlength="1000"
        #descriptionInput="ngModel"
      />

      @if (descriptionInput.errors) {
        @switch (true) {
          @case (nameInput.hasError('required')) {
            Beskrivning måste vara mellan 3 and 1000 tecken.
          }
          @case (descriptionInput.hasError('maxlength')) {
            Beskrivning måste vara mellan 3 and 1000 tecken.
          }
        }
      }
    </p>

    <p>
      <label for="type">Typ</label>
      <select name="type" id="type" [(ngModel)]="enteredType">
        <option value="MAINTENANCE">Maintenance</option>
        <option value="DAMAGE">Damage</option>
        <option value="UTILITY">Utility</option>
        <option value="SECURITY">Security</option>
        <option value="PEST">Pest</option>
        <option value="WEATHER">Weather</option>
        <option value="OTHER">Other</option>
      </select>
    </p>

    <p>
      <label for="priority">Prioritet</label>
      <select name="type" id="type" [(ngModel)]="enteredPriority">
        <option value="LOW">Low</option>
        <option value="MEDIUM">Medium</option>
        <option value="HIGH">High</option>
        <option value="CRITICAL">Critical</option>
      </select>
    </p>

    <p>
      <label for="status">Ärendestatus</label>
      <select name="type" id="type" [(ngModel)]="enteredStatus">
        <option value="NEW">New</option>
        <option value="INVESTIGATING">Investigation</option>
        <option value="IN_PROGRESS">In progress</option>
        <option value="RESOLVED">Resolved</option>
        <option value="CLOSED">Closed</option>
      </select>
    </p>

    <p>
      <label class="form-group required" for="reportedBy">Rapported av</label>
      <input
        type="text"
        id="reportedBy"
        name="reportedBy" [(ngModel)]="enteredReportedBy"
        pattern="^[a-zA-Z0-9 ]+$"
        minlength="3"
        maxlength="30"
        #reportedByInput="ngModel"
      />

      @if (reportedByInput.errors) {
        @switch (true) {
          @case (reportedByInput.hasError('pattern')) {
            ReportedBy must contain only letters, numbers and spaces
          }
          @case (reportedByInput.hasError('minlength')) {
            ReportedBy must be at least 3 characters long
          }
          @case (reportedByInput.hasError('maxlength')) {
            ReportedBy must be at most 30 characters long
          }
        }
      }

    </p>

    <p>
      <label for="assignedTo">Tilldelad</label>
      <input type="text" id="assignedTo" name="assignedTo" [(ngModel)]="enteredAssignedTo"/>
    </p>

    <p>
      <label for="location">Plats</label>
      <input type="text" id="location" name="location" [(ngModel)]="enteredLocation"/>
    </p>

    <p>
      <label for="estimatedCost">Uppskattad kostnad</label>
      <input type="text" id="estimatedCost" name="estimatedCost" [(ngModel)]="enteredEstimatedCost"/>
    </p>

    <p>
      <label for="actualCost">Faktisk kostnad</label>
      <input type="text" id="actualCost" name="actualCost" [(ngModel)]="enteredActualCost"/>
    </p>

    <p>
      <label for="startTime">Starttid</label>
      <input type="datetime-local" id="startTime" name="startTime"
             [ngModel]="enteredStartTime | date:'yyyy-MM-ddTHH:mm'"
             (ngModelChange)="handleStartTimeChange($event)"/>
    </p>

    <p>
      <label for="resolvedTime">Datum färdigställt</label>
      <input type="datetime-local" id="resolvedTime" name="resolvedTime"
             [ngModel]="enteredResolvedTime | date:'yyyy-MM-ddTHH:mm'"
             (ngModelChange)="handleResolvedTimeChange($event)"/>
    </p>

    <p>
      <label for="resolution">Lösning</label>
      <input type="text" id="resolution" name="resolution" [(ngModel)]="enteredResolution"/>
    </p>

    <p>
      <label for="requiresContractor">Kräver medgivande</label>
      <input type="checkbox" id="requiresContractor" name="requiresContractor" [(ngModel)]="enteredRequiresContractor"/>
    </p>

    <p>
      <label for="contractorInfo">Medgivandeinformation</label>
      <input type="text" id="contractorInfo" name="contractorInfo" [(ngModel)]="enteredContractorInfo"/>
    </p>

    <p>
      <label for="message">Meddelande</label>
      <input type="text" id="message" name="message" [(ngModel)]="enteredMessage"/>
    </p>

    <p>
      <label for="updatedBy">Uppdaterad av</label>
      <input type="text" id="updatedBy" name="updatedBy" [(ngModel)]="enteredUpdatedBy"/>
    </p>

    <p>
      <label for="updates">Uppdateringar</label>
      <input type="text" id="updates" name="updates" [(ngModel)]="enteredUpdates"/>
    </p>

    <p>
      <label for="tags">Taggar</label>
      <input type="text" id="tags" name="tags" [(ngModel)]="enteredTags"/>
    </p>

    <p class="actions">
      <button type="submit">Spara</button>
      <button type="button" (click)="onCancel()">Stäng</button>
    </p>
  </form>
</dialog>
