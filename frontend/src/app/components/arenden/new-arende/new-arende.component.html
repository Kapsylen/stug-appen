<div class="backdrop" (click)="onCancel()"></div>
<dialog open>
  <h2>Nytt Ärende</h2>
  <form (ngSubmit)="onSubmit()">
    <p>
      <label class="form-group required" for="name">Namn</label>
      <input type="text"
             id="name"
             name="name" [(ngModel)]="enteredName"
             minlength="3"
             maxlength="100"
             #nameInput="ngModel"
      />

      @if (nameInput.hasError('minlength') || nameInput.hasError('maxlength') || nameInput.hasError('pattern')) {
        Rubrik måste vara mellan 3 and 100 tecken.
      }
    </p>

    <p>
      <label class="form-group required" for="description">Beskrivning</label>
      <input
        type="text"
        id="description"
        name="description" [(ngModel)]="enteredDescription"
        minlength="3"
        maxlength="1000"
        #descriptionInput="ngModel"
      />

      @if (descriptionInput.hasError('minlength') || descriptionInput.hasError('maxlength')) {
        Beskrivning måste vara mellan 3 and 1000 tecken.
      }

    </p>

    <p>
      <label for="type">Typ</label>
      <select name="type" id="type" [(ngModel)]="enteredType">
        <option value="MAINTENANCE">Maintenance</option>
        <option value="DAMAGE">Damage</option>
        <option value="UTILITY">Utility</option>
        <option value="SECURITY">Security</option>
        <option value="PEST">Pest</option>
        <option value="WEATHER">Weather</option>
        <option value="OTHER">Other</option>
      </select>
    </p>

    <p>
      <label for="priority">Prioritet</label>
      <select name="type" id="type" [(ngModel)]="enteredPriority">
        <option value="LOW">Low</option>
        <option value="MEDIUM">Medium</option>
        <option value="HIGH">High</option>
        <option value="CRITICAL">Critical</option>
      </select>
    </p>

    <p>
      <label for="status">Ärendestatus</label>
      <select name="type" id="type" [(ngModel)]="enteredStatus">
        <option value="NEW">New</option>
        <option value="INVESTIGATING">Investigation</option>
        <option value="IN_PROGRESS">In progress</option>
        <option value="RESOLVED">Resolved</option>
        <option value="CLOSED">Closed</option>
      </select>
    </p>

    <p>
      <label class="form-group required" for="reportedBy">Rapported av</label>
      <input
        type="text"
        id="reportedBy"
        name="reportedBy" [(ngModel)]="enteredReportedBy"
        pattern="^[a-zA-Z0-9]{3,20}$"
        #reportedByInput="ngModel"
      />

      @if (reportedByInput.hasError('pattern')) {
        Rapporterad av måste innehålla endast bokstäver, siffror och mellan 3 och 20 tecken.
      }
    </p>

    <p>
      <label class="form-group required" for="assignedTo">Tilldelad</label>
      <input
        type="text"
        id="assignedTo"
        name="assignedTo" [(ngModel)]="enteredAssignedTo"
        pattern="^[a-zA-Z0-9]{3,20}$"
        #assignedToInput="ngModel"
      />

     @if (assignedToInput.hasError('pattern')) {
       Tilldelad av måste innehålla endast bokstäver, siffror och mellan 3 och 20 tecken.
     }
    </p>

    <p>
      <label for="location">Plats</label>
      <input type="text" id="location" name="location" [(ngModel)]="enteredLocation"/>
    </p>

    <p>
      <label class="form-group required" for="estimatedCost">Uppskattad kostnad</label>
      <input
        type="number"
        id="estimatedCost"
        name="estimatedCost" [(ngModel)]="enteredEstimatedCost"
        min="0"
        max="999999999"
        #estimatedCost="ngModel"
      />

      @if (estimatedCost.hasError('min') || estimatedCost.hasError('max')) {
        Priset behöver vara mellan 0 and 1000000.
      }
    </p>

    <p>
      <label for="actualCost">Faktisk kostnad</label>
      <input type="number" id="actualCost" name="actualCost" [(ngModel)]="enteredActualCost"/>
    </p>

    <p>
      <label for="startTime">Starttid</label>
      <input type="datetime-local" id="startTime" name="startTime"
             [ngModel]="enteredStartTime | date:'yyyy-MM-ddTHH:mm'"
             (ngModelChange)="handleStartTimeChange($event)"/>
    </p>

    <p>
      <label for="resolvedTime">Datum färdigställt</label>
      <input type="datetime-local" id="resolvedTime" name="resolvedTime"
             [ngModel]="enteredResolvedTime | date:'yyyy-MM-ddTHH:mm'"
             (ngModelChange)="handleResolvedTimeChange($event)"/>
    </p>

    <p>
      <label for="resolution">Lösning</label>
      <input type="text" id="resolution" name="resolution" [(ngModel)]="enteredResolution"/>
    </p>

    <p>
      <label for="requiresContractor">Kräver medgivande</label>
      <input type="checkbox" id="requiresContractor" name="requiresContractor" [(ngModel)]="enteredRequiresContractor"/>
    </p>

    <p>
      <label for="contractorInfo">Medgivandeinformation</label>
      <input type="text" id="contractorInfo" name="contractorInfo" [(ngModel)]="enteredContractorInfo"/>
    </p>

    <p>
      <label class="form-group required" for="message">Meddelande</label>
      <input
        type="text"
        id="message"
        name="message" [(ngModel)]="enteredMessage"
        minlength="3"
        maxlength="1000"
        #messageInput="ngModel"
      />
      @if (messageInput.hasError('minlength') || messageInput.hasError('maxlength')) {
        Meddelande måste mellan från 3 och 1000 tecken.
      }
    </p>

    <p>
      <label class="form-group required" for="updatedBy">Uppdaterad av</label>
      <input
        type="text"
        id="updatedBy"
        name="updatedBy" [(ngModel)]="enteredUpdatedBy"
        pattern="^[a-zA-Z0-9]{3,20}$"
        #updatedByInput="ngModel"
      />

      @if (updatedByInput.hasError('pattern')) {
        Uppdaterad av måste innehålla endast bokstäver, siffror och mellan 3 och 20 tecken.
      }
    </p>

    <p>
      <label for="updates">Uppdateringar</label>
      <input type="text" id="updates" name="updates" [(ngModel)]="enteredUpdates"/>
    </p>

    <p>
      <label for="tags">Taggar</label>
      <input type="text" id="tags" name="tags" [(ngModel)]="enteredTags"/>
    </p>

    <p class="actions">
      <button type="submit">Spara</button>
      <button type="button" (click)="onCancel()">Stäng</button>
    </p>
  </form>
</dialog>
